(()=>{var l=chrome.runtime.getManifest().manifest_version===3,c=(()=>{let e={setIcon:()=>{},setPopup:()=>{}};return l?chrome.action||e:chrome.browserAction||e})();c.setIcon({path:{16:chrome.runtime.getURL("assets/icon-bw16.png"),48:chrome.runtime.getURL("assets/icon-bw48.png"),128:chrome.runtime.getURL("assets/icon-bw128.png")}});var i={};chrome.runtime.onConnect.addListener(e=>{let n=null,s=null;if(console.log("Connection event in the background script"),u(e.name))n=e.name,console.log("Angular devtools connected, injecting the content script",e.name,i[n]),s="devtools",p(parseInt(e.name,10));else{if(!e.sender||!e.sender.tab){console.error("Unable to access the port sender and sender tab");return}if(e.sender.tab.id===void 0){console.error("Sender tab id is undefined");return}console.log("Content script connected",e.sender.tab.id),n=e.sender.tab.id.toString(),s="content-script"}let t=i[n];t||(console.log("Creating a tab port"),t=i[n]={devtools:null,"content-script":null}),t[s]=e,t.devtools&&t["content-script"]&&g(t.devtools,t["content-script"],n)});var u=e=>+e+""===e,p=e=>{if(console.log("Installing the content-script"),l){chrome.scripting.executeScript({files:["app/content_script_bundle.js"],target:{tabId:e}},()=>{chrome.scripting.executeScript({func:()=>globalThis.main(),target:{tabId:e}})});return}chrome.tabs.executeScript(e,{file:"app/content_script_bundle.js"},n=>{chrome.tabs.executeScript(e,{code:"globalThis.main()"})})},g=(e,n,s)=>{if(e===null){console.warn("DevTools port is equal to null");return}console.log("Creating two-way communication channel",Date.now(),i);let t=o=>{n.postMessage(o)};e.onMessage.addListener(t);let r=o=>{e.postMessage(o)};n.onMessage.addListener(r);let a=o=>{console.log("Disconnecting",o),e.onMessage.removeListener(t),n.onMessage.removeListener(r),e.disconnect(),n.disconnect(),i[s]=void 0};e.onDisconnect.addListener(a.bind(null,"devtools")),n.onDisconnect.addListener(a.bind(null,"content-script"))},d=e=>e.isAngular?!e.isIvy||!e.isSupportedAngularVersion?"unsupported.html":e.isDebugMode?"supported.html":"production.html":"not-angular.html";chrome.runtime.onMessage.addListener((e,n)=>{!e.isAngularDevTools||(n&&n.tab&&c.setPopup({tabId:n.tab.id,popup:`popups/${d(e)}`}),n&&n.tab&&e.isAngular&&c.setIcon({tabId:n.tab.id,path:{16:chrome.runtime.getURL("assets/icon16.png"),48:chrome.runtime.getURL("assets/icon48.png"),128:chrome.runtime.getURL("assets/icon128.png")}}))});})();
/**
 * @license
 * Copyright Google LLC All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */
//# sourceMappingURL=background_bundle.js.map
